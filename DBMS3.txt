CREATE TABLE Students (
  StudentID INT PRIMARY KEY,
  Name VARCHAR(100),
  Email VARCHAR(100)
);

CREATE TABLE Courses (
  CourseID INT PRIMARY KEY,
  Title VARCHAR(100),
  Credits INT
);

CREATE TABLE Enrollments (
  StudentID INT,
  CourseID INT,
  Grade CHAR(1),        -- A, B, C, D, F
  PRIMARY KEY (StudentID, CourseID),
  FOREIGN KEY (StudentID) REFERENCES Students(StudentID),
  FOREIGN KEY (CourseID) REFERENCES Courses(CourseID)
);


INSERT INTO Students VALUES
(1,'Aisha Khan','aisha@example.com'),
(2,'Ben Patel','ben@example.com'),
(3,'Cara Rao','cara@example.com');

INSERT INTO Courses VALUES
(10,'Database Systems',3),
(11,'Algorithms',4),
(12,'Operating Systems',4);

INSERT INTO Enrollments VALUES
(1,10,'A'),
(2,10,'B'),
(3,11,'A'),
(2,11,'C'),
(1,12,'B');


SELECT c.CourseID, c.Title,
       AVG(
         CASE e.Grade
           WHEN 'A' THEN 4
           WHEN 'B' THEN 3
           WHEN 'C' THEN 2
           WHEN 'D' THEN 1
           WHEN 'F' THEN 0
           ELSE NULL
         END
       ) AS AvgGrade
FROM Courses c
LEFT JOIN Enrollments e ON c.CourseID = e.CourseID
GROUP BY c.CourseID, c.Title;


SELECT * FROM Students
ORDER BY Name ASC;


SELECT s.StudentID, s.Name, s.Email
FROM Students s
JOIN Enrollments e ON s.StudentID = e.StudentID
JOIN Courses c ON e.CourseID = c.CourseID
WHERE c.Title = 'Database Systems';


DELETE FROM Courses c
WHERE NOT EXISTS (
  SELECT 1 FROM Enrollments e WHERE e.CourseID = c.CourseID
);


SELECT DISTINCT s.StudentID, s.Name, s.Email
FROM Students s
JOIN Enrollments e ON s.StudentID = e.StudentID
WHERE e.Grade = 'A';
